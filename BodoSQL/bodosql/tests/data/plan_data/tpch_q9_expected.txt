PandasSort(sort0=[$0], sort1=[$1], dir0=[ASC-nulls-first], dir1=[DESC-nulls-last])
  PandasAggregate(group=[{0, 1}], sum_profit=[SUM($2)])
    PandasProject(nation=[$7], o_year=[EXTRACT(FLAG(YEAR), $5)], amount=[-(*($2, -(1, $3)), *($4, $1))])
      PandasJoin(condition=[=($0, $6)], joinType=[inner])
        PandasProject(S_NATIONKEY=[$0], L_QUANTITY=[$2], L_EXTENDEDPRICE=[$3], L_DISCOUNT=[$4], PS_SUPPLYCOST=[$5], O_ORDERDATE=[$7])
          PandasJoin(condition=[=($6, $1)], joinType=[inner])
            PandasProject(S_NATIONKEY=[$0], L_ORDERKEY=[$1], L_QUANTITY=[$4], L_EXTENDEDPRICE=[$5], L_DISCOUNT=[$6], PS_SUPPLYCOST=[$9])
              PandasJoin(condition=[AND(=($8, $3), =($7, $2))], joinType=[inner])
                PandasProject(S_NATIONKEY=[$2], L_ORDERKEY=[$3], L_PARTKEY=[$4], L_SUPPKEY=[$5], L_QUANTITY=[$6], L_EXTENDEDPRICE=[$7], L_DISCOUNT=[$8])
                  PandasJoin(condition=[AND(=($1, $5), =($0, $4))], joinType=[inner])
                    PandasJoin(condition=[true], joinType=[inner])
                      PandasProject(P_PARTKEY=[$0])
                        PandasFilter(condition=[LIKE($1, '%green%')])
                          PandasTableScan(table=[[__bodolocal__, part]])
                      PandasProject(S_SUPPKEY=[$0], S_NATIONKEY=[$3])
                        PandasTableScan(table=[[__bodolocal__, supplier]])
                    PandasProject(L_ORDERKEY=[$0], L_PARTKEY=[$1], L_SUPPKEY=[$2], L_QUANTITY=[$4], L_EXTENDEDPRICE=[$5], L_DISCOUNT=[$6])
                      PandasTableScan(table=[[__bodolocal__, lineitem]])
                PandasProject(PS_PARTKEY=[$0], PS_SUPPKEY=[$1], PS_SUPPLYCOST=[$3])
                  PandasFilter(condition=[AND(IS NOT NULL($1), IS NOT NULL($0))])
                    PandasTableScan(table=[[__bodolocal__, partsupp]])
            PandasProject(O_ORDERKEY=[$0], O_ORDERDATE=[$4])
              PandasTableScan(table=[[__bodolocal__, orders]])
        PandasProject(N_NATIONKEY=[$0], N_NAME=[$1])
          PandasTableScan(table=[[__bodolocal__, nation]])
