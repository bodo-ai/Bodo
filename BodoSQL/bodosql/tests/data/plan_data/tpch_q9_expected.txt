LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC-nulls-first], dir1=[DESC-nulls-last])
  LogicalAggregate(group=[{0, 1}], sum_profit=[SUM($2)])
    LogicalProject(nation=[$7], o_year=[EXTRACT(FLAG(YEAR), $5)], amount=[-(*($2, -(1, $3)), *($4, $1))])
      LogicalJoin(condition=[=($0, $6)], joinType=[inner])
        LogicalProject(S_NATIONKEY=[$0], L_QUANTITY=[$2], L_EXTENDEDPRICE=[$3], L_DISCOUNT=[$4], PS_SUPPLYCOST=[$5], O_ORDERDATE=[$7])
          LogicalJoin(condition=[=($6, $1)], joinType=[inner])
            LogicalProject(S_NATIONKEY=[$0], L_ORDERKEY=[$1], L_QUANTITY=[$4], L_EXTENDEDPRICE=[$5], L_DISCOUNT=[$6], PS_SUPPLYCOST=[$9])
              LogicalJoin(condition=[AND(=($8, $3), =($7, $2))], joinType=[inner])
                LogicalProject(S_NATIONKEY=[$2], L_ORDERKEY=[$3], L_PARTKEY=[$4], L_SUPPKEY=[$5], L_QUANTITY=[$6], L_EXTENDEDPRICE=[$7], L_DISCOUNT=[$8])
                  LogicalJoin(condition=[AND(=($1, $5), =($0, $4))], joinType=[inner])
                    LogicalJoin(condition=[true], joinType=[inner])
                      LogicalProject(P_PARTKEY=[$0])
                        LogicalFilter(condition=[LIKE($1, '%green%')])
                          LogicalTableScan(table=[[__bodolocal__, part]])
                      LogicalProject(S_SUPPKEY=[$0], S_NATIONKEY=[$3])
                        LogicalTableScan(table=[[__bodolocal__, supplier]])
                    LogicalProject(L_ORDERKEY=[$0], L_PARTKEY=[$1], L_SUPPKEY=[$2], L_QUANTITY=[$4], L_EXTENDEDPRICE=[$5], L_DISCOUNT=[$6])
                      LogicalTableScan(table=[[__bodolocal__, lineitem]])
                LogicalProject(PS_PARTKEY=[$0], PS_SUPPKEY=[$1], PS_SUPPLYCOST=[$3])
                  LogicalFilter(condition=[AND(IS NOT NULL($1), IS NOT NULL($0))])
                    LogicalTableScan(table=[[__bodolocal__, partsupp]])
            LogicalProject(O_ORDERKEY=[$0], O_ORDERDATE=[$4])
              LogicalTableScan(table=[[__bodolocal__, orders]])
        LogicalProject(N_NATIONKEY=[$0], N_NAME=[$1])
          LogicalTableScan(table=[[__bodolocal__, nation]])
