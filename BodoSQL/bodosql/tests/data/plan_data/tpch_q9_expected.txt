LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC-nulls-first], dir1=[DESC-nulls-last])
  LogicalProject(nation=[$1], o_year=[$0], sum_profit=[$2])
    LogicalAggregate(group=[{0, 1}], sum_profit=[SUM($2)])
      LogicalProject(o_year=[$1], N_NAME=[$4], $f6=[*($2, $5)])
        LogicalJoin(condition=[=($0, $3)], joinType=[inner])
          LogicalAggregate(group=[{0, 1}], sum_profit=[SUM($2)])
            LogicalProject(S_NATIONKEY=[$0], o_year=[$4], $f6=[*($2, $5)])
              LogicalJoin(condition=[=($3, $1)], joinType=[inner])
                LogicalAggregate(group=[{0, 1}], sum_profit=[SUM($2)])
                  LogicalProject(S_NATIONKEY=[$0], L_ORDERKEY=[$1], amount=[-($5, *($8, $4))])
                    LogicalJoin(condition=[AND(=($7, $3), =($6, $2))], joinType=[inner])
                      LogicalProject(S_NATIONKEY=[$2], L_ORDERKEY=[$3], L_PARTKEY=[$4], L_SUPPKEY=[$5], L_QUANTITY=[$6], EXPR$0=[$7])
                        LogicalJoin(condition=[AND(=($1, $5), =($0, $4))], joinType=[inner])
                          LogicalJoin(condition=[true], joinType=[inner])
                            LogicalProject(P_PARTKEY=[$0])
                              LogicalFilter(condition=[LIKE($1, '%green%')])
                                LogicalTableScan(table=[[__bodolocal__, part]])
                            LogicalProject(S_SUPPKEY=[$0], S_NATIONKEY=[$3])
                              LogicalTableScan(table=[[__bodolocal__, supplier]])
                          LogicalProject(L_ORDERKEY=[$0], L_PARTKEY=[$1], L_SUPPKEY=[$2], L_QUANTITY=[$4], EXPR$0=[*($5, -(1, $6))])
                            LogicalTableScan(table=[[__bodolocal__, lineitem]])
                      LogicalFilter(condition=[AND(IS NOT NULL($1), IS NOT NULL($0))])
                        LogicalProject(PS_PARTKEY=[$0], PS_SUPPKEY=[$1], PS_SUPPLYCOST=[$3])
                          LogicalTableScan(table=[[__bodolocal__, partsupp]])
                LogicalAggregate(group=[{0, 1}], agg#0=[COUNT()])
                  LogicalProject(O_ORDERKEY=[$0], o_year=[EXTRACT(FLAG(YEAR), $4)])
                    LogicalTableScan(table=[[__bodolocal__, orders]])
          LogicalAggregate(group=[{0, 1}], agg#0=[COUNT()])
            LogicalTableScan(table=[[__bodolocal__, nation]])
