LogicalSort(sort0=[$0], dir0=[ASC-nulls-first])
  LogicalProject(o_year=[$0], mkt_share=[/($1, $2)])
    LogicalAggregate(group=[{0}], agg#0=[SUM($1)], agg#1=[SUM($2)])
      LogicalProject(o_year=[$0], $f1=[CASE(=($2, 'BRAZIL'), $1, 0:DOUBLE)], volume=[$1])
        LogicalProject(o_year=[EXTRACT(FLAG(YEAR), $2)], volume=[*($0, -(1, $1))], $f2=[$4])
          LogicalJoin(condition=[=($3, $5)], joinType=[inner])
            LogicalProject(L_EXTENDEDPRICE=[$1], L_DISCOUNT=[$2], O_ORDERDATE=[$3], N_REGIONKEY=[$4], N_NAME0=[$6])
              LogicalJoin(condition=[=($0, $5)], joinType=[inner])
                LogicalProject(S_NATIONKEY=[$0], L_EXTENDEDPRICE=[$1], L_DISCOUNT=[$2], O_ORDERDATE=[$3], N_REGIONKEY=[$6])
                  LogicalJoin(condition=[=($4, $5)], joinType=[inner])
                    LogicalProject(S_NATIONKEY=[$0], L_EXTENDEDPRICE=[$1], L_DISCOUNT=[$2], O_ORDERDATE=[$4], C_NATIONKEY=[$6])
                      LogicalJoin(condition=[=($3, $5)], joinType=[inner])
                        LogicalProject(S_NATIONKEY=[$0], L_EXTENDEDPRICE=[$2], L_DISCOUNT=[$3], O_CUSTKEY=[$5], O_ORDERDATE=[$6])
                          LogicalJoin(condition=[=($1, $4)], joinType=[inner])
                            LogicalProject(S_NATIONKEY=[$2], L_ORDERKEY=[$3], L_EXTENDEDPRICE=[$6], L_DISCOUNT=[$7])
                              LogicalJoin(condition=[AND(=($0, $4), =($1, $5))], joinType=[inner])
                                LogicalJoin(condition=[true], joinType=[inner])
                                  LogicalProject(P_PARTKEY=[$0])
                                    LogicalFilter(condition=[=($4, 'ECONOMY ANODIZED STEEL')])
                                      LogicalTableScan(table=[[__bodolocal__, part]])
                                  LogicalProject(S_SUPPKEY=[$0], S_NATIONKEY=[$3])
                                    LogicalTableScan(table=[[__bodolocal__, supplier]])
                                LogicalProject(L_ORDERKEY=[$0], L_PARTKEY=[$1], L_SUPPKEY=[$2], L_EXTENDEDPRICE=[$5], L_DISCOUNT=[$6])
                                  LogicalTableScan(table=[[__bodolocal__, lineitem]])
                            LogicalProject(O_ORDERKEY=[$0], O_CUSTKEY=[$1], O_ORDERDATE=[$4])
                              LogicalFilter(condition=[AND(>=($4, CAST(1995-01-01):TIMESTAMP(0) NOT NULL), <=($4, CAST(1996-12-31):TIMESTAMP(0) NOT NULL))])
                                LogicalTableScan(table=[[__bodolocal__, orders]])
                        LogicalProject(C_CUSTKEY=[$0], C_NATIONKEY=[$3])
                          LogicalTableScan(table=[[__bodolocal__, customer]])
                    LogicalProject(N_NATIONKEY=[$0], N_REGIONKEY=[$2])
                      LogicalTableScan(table=[[__bodolocal__, nation]])
                LogicalProject(N_NATIONKEY=[$0], N_NAME=[$1])
                  LogicalTableScan(table=[[__bodolocal__, nation]])
            LogicalProject(R_REGIONKEY=[$0])
              LogicalFilter(condition=[=($1, 'AMERICA')])
                LogicalTableScan(table=[[__bodolocal__, region]])
