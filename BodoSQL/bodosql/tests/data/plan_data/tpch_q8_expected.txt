LogicalSort(sort0=[$0], dir0=[ASC-nulls-first])
  LogicalProject(o_year=[$0], mkt_share=[/($1, $2)])
    LogicalAggregate(group=[{0}], agg#0=[SUM($1)], agg#1=[SUM($2)])
      LogicalProject(o_year=[$1], $f6=[*($2, $5)], $f7=[*($3, $5)])
        LogicalJoin(condition=[=($0, $4)], joinType=[inner])
          LogicalAggregate(group=[{0, 1}], agg#0=[SUM($2)], agg#1=[SUM($3)])
            LogicalProject(N_REGIONKEY=[$1], o_year=[$2], $f1=[CASE($5, $3, 0:DOUBLE)], volume=[$3])
              LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                LogicalProject(S_NATIONKEY=[$0], N_REGIONKEY=[$5], o_year=[$2], volume=[$3])
                  LogicalJoin(condition=[=($1, $4)], joinType=[inner])
                    LogicalProject(S_NATIONKEY=[$0], C_NATIONKEY=[$5], o_year=[$2], volume=[$3])
                      LogicalJoin(condition=[=($1, $4)], joinType=[inner])
                        LogicalProject(S_NATIONKEY=[$0], O_CUSTKEY=[$4], o_year=[$5], volume=[$2])
                          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
                            LogicalProject(S_NATIONKEY=[$2], L_ORDERKEY=[$3], volume=[$6])
                              LogicalJoin(condition=[AND(=($0, $4), =($1, $5))], joinType=[inner])
                                LogicalJoin(condition=[true], joinType=[inner])
                                  LogicalProject(P_PARTKEY=[$0])
                                    LogicalFilter(condition=[=($4, 'ECONOMY ANODIZED STEEL')])
                                      LogicalTableScan(table=[[__bodolocal__, part]])
                                  LogicalProject(S_SUPPKEY=[$0], S_NATIONKEY=[$3])
                                    LogicalTableScan(table=[[__bodolocal__, supplier]])
                                LogicalProject(L_ORDERKEY=[$0], L_PARTKEY=[$1], L_SUPPKEY=[$2], volume=[*($5, -(1, $6))])
                                  LogicalTableScan(table=[[__bodolocal__, lineitem]])
                            LogicalProject(O_ORDERKEY=[$0], O_CUSTKEY=[$1], o_year=[EXTRACT(FLAG(YEAR), $4)])
                              LogicalFilter(condition=[AND(>=($4, CAST(1995-01-01):TIMESTAMP(0) NOT NULL), <=($4, CAST(1996-12-31):TIMESTAMP(0) NOT NULL))])
                                LogicalTableScan(table=[[__bodolocal__, orders]])
                        LogicalProject(C_CUSTKEY=[$0], C_NATIONKEY=[$3])
                          LogicalTableScan(table=[[__bodolocal__, customer]])
                    LogicalProject(N_NATIONKEY=[$0], N_REGIONKEY=[$2])
                      LogicalTableScan(table=[[__bodolocal__, nation]])
                LogicalProject(N_NATIONKEY=[$0], EXPR$0=[=($1, 'BRAZIL')])
                  LogicalTableScan(table=[[__bodolocal__, nation]])
          LogicalAggregate(group=[{0}], agg#0=[COUNT()])
            LogicalFilter(condition=[=($1, 'AMERICA')])
              LogicalTableScan(table=[[__bodolocal__, region]])
