PandasSort(sort0=[$0], dir0=[ASC-nulls-first])
  PandasProject(o_year=[$0], mkt_share=[/($1, $2)])
    PandasAggregate(group=[{0}], agg#0=[SUM($1)], agg#1=[SUM($2)])
      PandasProject(o_year=[$0], $f1=[CASE(=($2, 'BRAZIL'), $1, 0:DOUBLE)], volume=[$1])
        PandasProject(o_year=[EXTRACT(FLAG(YEAR), $2)], volume=[*($0, -(1, $1))], $f2=[$4])
          PandasJoin(condition=[=($3, $5)], joinType=[inner], rebalanceOutput=[true])
            PandasProject(L_EXTENDEDPRICE=[$1], L_DISCOUNT=[$2], O_ORDERDATE=[$3], N_REGIONKEY=[$4], N_NAME0=[$6])
              PandasJoin(condition=[=($0, $5)], joinType=[inner])
                PandasProject(S_NATIONKEY=[$0], L_EXTENDEDPRICE=[$1], L_DISCOUNT=[$2], O_ORDERDATE=[$3], N_REGIONKEY=[$6])
                  PandasJoin(condition=[=($4, $5)], joinType=[inner])
                    PandasProject(S_NATIONKEY=[$0], L_EXTENDEDPRICE=[$1], L_DISCOUNT=[$2], O_ORDERDATE=[$4], C_NATIONKEY=[$6])
                      PandasJoin(condition=[=($3, $5)], joinType=[inner])
                        PandasProject(S_NATIONKEY=[$0], L_EXTENDEDPRICE=[$2], L_DISCOUNT=[$3], O_CUSTKEY=[$5], O_ORDERDATE=[$6])
                          PandasJoin(condition=[=($1, $4)], joinType=[inner])
                            PandasProject(S_NATIONKEY=[$2], L_ORDERKEY=[$3], L_EXTENDEDPRICE=[$6], L_DISCOUNT=[$7])
                              PandasJoin(condition=[AND(=($0, $4), =($1, $5))], joinType=[inner])
                                PandasJoin(condition=[true], joinType=[inner])
                                  PandasProject(P_PARTKEY=[$0])
                                    PandasFilter(condition=[=($4, 'ECONOMY ANODIZED STEEL')])
                                      PandasTableScan(table=[[__bodolocal__, part]])
                                  PandasProject(S_SUPPKEY=[$0], S_NATIONKEY=[$3])
                                    PandasTableScan(table=[[__bodolocal__, supplier]])
                                PandasProject(L_ORDERKEY=[$0], L_PARTKEY=[$1], L_SUPPKEY=[$2], L_EXTENDEDPRICE=[$5], L_DISCOUNT=[$6])
                                  PandasTableScan(table=[[__bodolocal__, lineitem]])
                            PandasProject(O_ORDERKEY=[$0], O_CUSTKEY=[$1], O_ORDERDATE=[$4])
                              PandasFilter(condition=[SEARCH($4, Sarg[[1995-01-01..1996-12-31]])])
                                PandasTableScan(table=[[__bodolocal__, orders]])
                        PandasProject(C_CUSTKEY=[$0], C_NATIONKEY=[$3])
                          PandasTableScan(table=[[__bodolocal__, customer]])
                    PandasProject(N_NATIONKEY=[$0], N_REGIONKEY=[$2])
                      PandasTableScan(table=[[__bodolocal__, nation]])
                PandasProject(N_NATIONKEY=[$0], N_NAME=[$1])
                  PandasTableScan(table=[[__bodolocal__, nation]])
            PandasProject(R_REGIONKEY=[$0])
              PandasFilter(condition=[=($1, 'AMERICA')])
                PandasTableScan(table=[[__bodolocal__, region]])
