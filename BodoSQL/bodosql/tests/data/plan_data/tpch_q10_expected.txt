LogicalSort(sort0=[$2], sort1=[$0], dir0=[DESC-nulls-last], dir1=[ASC-nulls-first], fetch=[20])
  LogicalProject(c_custkey=[$0], c_name=[$1], revenue=[$7], c_acctbal=[$4], n_name=[$6], c_address=[$2], c_phone=[$3], c_comment=[$5])
    LogicalAggregate(group=[{0, 1, 2, 3, 4, 5, 6}], revenue=[SUM($7)])
      LogicalProject(C_CUSTKEY=[$0], C_NAME=[$1], C_ADDRESS=[$2], C_PHONE=[$4], C_ACCTBAL=[$5], C_COMMENT=[$6], N_NAME=[$9], $f11=[*($7, $10)])
        LogicalJoin(condition=[=($3, $8)], joinType=[inner])
          LogicalAggregate(group=[{0, 1, 2, 3, 4, 5, 6}], revenue=[SUM($7)])
            LogicalProject(C_CUSTKEY=[$0], C_NAME=[$1], C_ADDRESS=[$2], C_NATIONKEY=[$3], C_PHONE=[$4], C_ACCTBAL=[$5], C_COMMENT=[$6], $f11=[*($8, $10)])
              LogicalJoin(condition=[=($9, $7)], joinType=[inner])
                LogicalProject(C_CUSTKEY=[$0], C_NAME=[$1], C_ADDRESS=[$2], C_NATIONKEY=[$3], C_PHONE=[$4], C_ACCTBAL=[$5], C_COMMENT=[$6], O_ORDERKEY=[$8], $f11=[*($7, $10)])
                  LogicalJoin(condition=[=($0, $9)], joinType=[inner])
                    LogicalAggregate(group=[{0, 1, 2, 3, 4, 5, 7}], agg#0=[COUNT()])
                      LogicalTableScan(table=[[__bodolocal__, customer]])
                    LogicalAggregate(group=[{0, 1}], agg#0=[COUNT()])
                      LogicalFilter(condition=[AND(>=($4, CAST('1993-10-01'):TIMESTAMP(0) NOT NULL), <($4, CAST('1994-01-01'):TIMESTAMP(0) NOT NULL))])
                        LogicalTableScan(table=[[__bodolocal__, orders]])
                LogicalAggregate(group=[{0}], revenue=[SUM($1)])
                  LogicalProject(L_ORDERKEY=[$0], $f7=[*($5, -(1, $6))])
                    LogicalFilter(condition=[=($8, 'R')])
                      LogicalTableScan(table=[[__bodolocal__, lineitem]])
          LogicalAggregate(group=[{0, 1}], agg#0=[COUNT()])
            LogicalTableScan(table=[[__bodolocal__, nation]])
