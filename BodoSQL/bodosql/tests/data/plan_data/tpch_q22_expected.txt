PandasSort(sort0=[$0], dir0=[ASC-nulls-first])
  PandasAggregate(group=[{0}], numcust=[COUNT()], totacctbal=[SUM($1)])
    PandasProject(cntrycode=[SUBSTRING($4, 1, 2)], c_acctbal=[$5])
      PandasFilter(condition=[IS NULL($10)])
        PandasJoin(condition=[=($0, $9)], joinType=[left])
          PandasJoin(condition=[>($5, $8)], joinType=[inner])
            PandasFilter(condition=[OR(=(SUBSTRING($4, 1, 2), '13'), =(SUBSTRING($4, 1, 2), '31'), =(SUBSTRING($4, 1, 2), '23'), =(SUBSTRING($4, 1, 2), '29'), =(SUBSTRING($4, 1, 2), '30'), =(SUBSTRING($4, 1, 2), '18'), =(SUBSTRING($4, 1, 2), '17'))])
              PandasTableScan(table=[[__bodolocal__, customer]])
            PandasAggregate(group=[{}], EXPR$0=[AVG($5)])
              PandasFilter(condition=[AND(>($5, 0.00:DECIMAL(3, 2)), OR(=(SUBSTRING($4, 1, 2), '13'), =(SUBSTRING($4, 1, 2), '31'), =(SUBSTRING($4, 1, 2), '23'), =(SUBSTRING($4, 1, 2), '29'), =(SUBSTRING($4, 1, 2), '30'), =(SUBSTRING($4, 1, 2), '18'), =(SUBSTRING($4, 1, 2), '17')))])
                PandasTableScan(table=[[__bodolocal__, customer]])
          PandasProject(O_CUSTKEY=[$0], $f1=[true])
            PandasAggregate(group=[{1}])
              PandasFilter(condition=[IS NOT NULL($1)])
                PandasTableScan(table=[[__bodolocal__, orders]])
